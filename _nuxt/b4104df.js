(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{398:function(e,t,n){"use strict";(function(e){n(28),n(32),n(19),n(24),n(33),n(34);var r=n(6),o=(n(51),n(57),n(97),n(35),n(23),n(96),n(18),n(113),n(58),n(59),n(104),n(7),n(20),n(185),n(77)),l=n.n(o),c=n(408),d=n.n(c),v=n(527);n(528);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var h,y=function(e){var t=document.createElement("div");t.className="pa-2";var n=document.createElement("div");n.className="mt-2",t.appendChild(n);var r=document.createElement("div");r.className="mt-2",t.appendChild(r);var o=e.annotation;o&&o.body.map((function(body){var e,div,t,button;"tagging"==body.purpose?r.appendChild((t=body.value,(button=document.createElement("span")).className="badge badge-secondary mr-1 mb-1 pa-1",button.innerHTML=t,button)):n.appendChild((e=body.value,(div=document.createElement("div")).innerHTML=e.trim(),div.firstChild))}));return t};t.a={components:{},data:function(){return{dialog:!1,detail:{},baseUrl:"https://nakamura196.github.io/nishikie2",search:"",rows:[],viewer:null,anno:null,tabs:"",items:[],thres:2e3,alert:!1,details:e.env.detail,hide:e.env.hide}},props:{aggs:{required:!0}},created:function(){this.init()},computed:{headers:function(){var t,n=[{text:"",value:"detail",sortable:!1},{text:this.$t("name"),value:"label"}],r=f(e.env.list);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push({text:this.$t(o.label),value:o.value})}}catch(e){r.e(e)}finally{r.f()}return n},isMobile:function(){return!!["xs","sm"].includes(this.$vuetify.breakpoint.name)}},methods:{zoom:function(e){this.anno.fitBounds(e)},init:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,o,data,l,c,d,v,map,m,h,y,x,w,_,k,label,C,S,j,$,A,O,R,E,I,N,M,body,T,J,D,L,z,B,U,H,V,P,F,W,G;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=JSON.parse(JSON.stringify(t.$route.query))).size=-1,r.max=-1,r.sort=r.sort||"_score:desc",n.next=6,t.$localEs.search(null,r,null);case 6:for(m in o=n.sent,data=o.data,l=data.hits.hits,t.alert=!1,c=data.aggregations,d=e.env.map,v=e.env.settings,map={},v)map[v[m].label]=m;if(h=[],y={},d){x=c[d].buckets,w=f(x);try{for(w.s();!(_=w.n()).done;)k=_.value,label=k.key,C=k.doc_count,S=map[label],h.push({id:S,label:label,value:C,annos:[],rows:[]}),y[label]=h.length-1}catch(e){w.e(e)}finally{w.f()}}else j="label","value","id",h.push({id:"id",label:j,value:"value",annos:[],rows:[]}),y.label=h.length-1;$=0,A=f(l),n.prev=20,A.s();case 22:if((O=A.n()).done){n.next=61;break}R=(R=O.value)._source,E="label",d&&(E=R[d][0]),I=h[y[E]],R.member.split("=")[1],I.image=R.image+"/info.json",N=I.annos,M=I.rows,body=[{type:"TextualBody",value:'<div><a href="'.concat(t.baseUrl+"/item/"+R.objectID,'">').concat(R.label,"</a></div>")}],n.t0=regeneratorRuntime.keys(R);case 34:if((n.t1=n.t0()).done){n.next=48;break}if(T=n.t1.value,J=t.$utils.formatArrayValue(R[T])){n.next=39;break}return n.abrupt("continue",34);case 39:if(!"".concat(J).startsWith("http")){n.next=41;break}return n.abrupt("continue",34);case 41:if(!["objectID","fulltext","label","sort","_updated"].includes(T)){n.next=43;break}return n.abrupt("continue",34);case 43:if(!["地名/記述","記号"].includes(T)){n.next=45;break}return n.abrupt("continue",34);case 45:body.push({type:"TextualBody",purpose:"tagging",value:T+": "+J}),n.next=34;break;case 48:D={"@context":"http://www.w3.org/ns/anno.jsonld",id:R.objectID,type:"Annotation",body:body,target:{selector:{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:R.member.split("#")[1]}}},N.push(D),L={id:R.objectID,label:R.label,index:$},z=e.env.list,B=f(z);try{for(B.s();!(U=B.n()).done;)H=U.value,V=H.value,L[V]=t.$utils.formatArrayValue(R[V])}catch(e){B.e(e)}finally{B.f()}if(M.push(L),!(($+=1)>=t.thres&&t.thres>0)){n.next=59;break}return t.alert=!0,n.abrupt("break",61);case 59:n.next=22;break;case 61:n.next=66;break;case 63:n.prev=63,n.t2=n.catch(20),A.e(n.t2);case 66:return n.prev=66,A.f(),n.finish(66);case 69:for(P=[],F=0,W=h;F<W.length;F++)(G=W[F]).annos.length>0&&(G.value=G.annos.length,P.push(G));t.items=P;case 72:case"end":return n.stop()}}),n,null,[[20,63,66,69]])})))()},update:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,f,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.anno=null,e.viewer=null,e.rows=[],document.getElementById("openseadragon").innerHTML="",n=e.items[Number(e.tabs)]){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,l.a.get(n.image);case 9:r=t.sent,o=r.data,c=d()({id:"openseadragon",prefixUrl:"https://recogito.github.io/js/openseadragon/images/",tileSources:o}),e.viewer=c,f={readOnly:!0,locale:e.$i18n.locale,widgets:[y]},m=v(c,f),e.anno=m,m.setAnnotations(n.annos),e.rows=n.rows;case 18:case"end":return t.stop()}}),t)})))()},showAll:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.thres=-1,t.next=3,e.init();case 3:e.update();case 4:case"end":return t.stop()}}),t)})))()}},watch:{tabs:function(e){this.update()},$route:(h=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.query,o=n.query,delete r.layout,delete r.page,delete r.max,delete o.layout,delete o.page,delete o.max,JSON.stringify(r)==JSON.stringify(o)){e.next=12;break}return e.next=11,this.init();case 11:this.update();case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})}}}).call(this,n(95))},409:function(e,t,n){var content=n(531);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(80).default)("29daf1c1",content,!1,{sourceMap:!1})},530:function(e,t,n){"use strict";n(409)},531:function(e,t,n){var r=n(79)(!1);r.push([e.i,".badge-secondary{color:#fff;background-color:#6c757d}.badge{display:inline-block;padding:.25em .4em;font-size:75%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}.openseadragon-canvas{outline:none;background-color:#f4f4f4!important}",""]),e.exports=r},676:function(e,t,n){"use strict";n.r(t);var r=n(398).a,o=(n(530),n(26)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-tabs",{staticClass:"my-5",style:e.items.length<2?"display:none":"",model:{value:e.tabs,callback:function(t){e.tabs=t},expression:"tabs"}},e._l(e.items,(function(t,r){return n("v-tab",{key:r,staticClass:"primary--text",attrs:{href:"#"+r}},[e._v("\n      "+e._s(t.label)+" ("+e._s(t.value.toLocaleString())+" "+e._s(e.$t("results"))+")\n    ")])})),1),e._v(" "),e.alert?n("v-alert",{staticClass:"my-5",attrs:{type:"warning",outlined:"",prominent:""}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{staticClass:"grow"},[e._v("\n        上位\n        "+e._s(e.thres.toLocaleString())+"\n        件の結果のみを表示しています。全件を表示するには、検索結果を絞り込んでください。もしくは、表示に時間がかかる可能性がありますが、右のボタンから全件を表示してください。\n      ")]),e._v(" "),n("v-col",{staticClass:"shrink"},[n("v-btn",{attrs:{color:"primary"},on:{click:function(t){return e.showAll()}}},[e._v("全件表示")])],1)],1)],1):e._e(),e._v(" "),n("v-row",{staticClass:"mb-5"},[e.isMobile?e._e():n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-data-table",{attrs:{headers:e.headers,items:e.rows,search:e.search},scopedSlots:e._u([{key:"top",fn:function(){return[n("v-text-field",{staticClass:"mx-4 my-5",attrs:{"background-color":"grey lighten-3",filled:"",rounded:"",dense:"","hide-details":"","single-line":"",placeholder:e.$t("add_a_search_term"),"append-icon":"mdi-magnify",clearable:"","clear-icon":"mdi-close-circle",label:e.$t("search")},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]},proxy:!0},{key:"item.label",fn:function(t){var r=t.item;return[n("nuxt-link",{attrs:{to:e.localePath({name:"item-id",params:{id:r.id}})}},[e._v(e._s(r.label))])]}},{key:"item.detail",fn:function(t){var r=t.item;return[n("a",{on:{click:function(t){return e.zoom(r.id)}}},[n("v-icon",{staticClass:"primary--text"},[e._v("mdi-select-search")])],1)]}}],null,!1,1802709209)})],1),e._v(" "),n("v-col",{attrs:{cols:"12",md:"8"}},[n("div",{staticStyle:{height:"600px",width:"100%"},attrs:{id:"openseadragon"}})])],1),e._v(" "),n("v-dialog",{attrs:{width:"500"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5 grey lighten-2"},[n("span",{staticClass:"text-h5"},[e._v(e._s(e.detail.label))])]),e._v(" "),n("v-card-text",{staticClass:"py-5",staticStyle:{height:"600px","overflow-y":"auto"}},[n("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[n("tbody",[e._l(e.details,(function(t,r){return[!e.hide[t.value]&&e.detail[t.value]&&e.detail[t.value].length>0?n("tr",{key:r},[n("td",[e._v(e._s(t.value))]),e._v(" "),n("td",[e._v(e._s(e.$utils.formatArrayValue(e.detail[t.value])))])]):e._e()]}))],2)]},proxy:!0}])})],1),e._v(" "),n("v-divider"),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("\n          "+e._s("閉じる")+"\n        ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",to:e.localePath({name:"item-id",params:{id:e.detail.objectID}})}},[e._v("\n          "+e._s("詳細を開く")+"\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);